\documentclass[12pt, a4paper]{amsart}
\usepackage{amsmath,amsfonts,amsthm,amssymb,color}
\usepackage{dsfont,tikz-cd,minitoc,pifont,tabu,biblatex}
\addbibresource{references.bib}

\usepackage{hyperref}

\begin{document}

% Latex template
%%%%%%%%%%%%%%%%%%%%%%%%% preamble

% theorem-type environments
\theoremstyle{plain}
\newtheorem{prop}{Proposition}[subsection]
\newtheorem{thm}[prop]{Theorem}
\newtheorem{cor}[prop]{Corollary}
\newtheorem{lemma}[prop]{Lemma}
\newtheorem{conj}[prop]{Conjecture}

\theoremstyle{definition}
\newtheorem{example}[prop]{Example}
\newtheorem{defn}[prop]{Definition}

\theoremstyle{remark}
\newtheorem{remark}[prop]{Remark}

\numberwithin{equation}{subsection}

% user-defomed macros
\newcommand{\defin}{\textbf}
\newcommand{\CC}{{\mathbb C}}
\newcommand{\cov}{{\operatorname{cov}}}
\newcommand{\eE}{{\mathcal E}}
\newcommand{\NN}{{\mathbb N}}
\newcommand{\PP}{{\mathbb P}}
\newcommand{\ZZ}{{\mathbb Z}}
\renewcommand{\SS}{{\mathbb S}}
\newcommand{\DD}{{\mathbb D}}
\newcommand{\RR}{{\mathbb R}}
\newcommand{\QQ}{{\mathbb Q}}
\newcommand{\rR}{{\mathcal R}}
\newcommand{\OO}{{\mathcal O}}
\newcommand{\p}{\partial}
\newcommand{\mM}{{\mathcal M}}
\newcommand{\pP}{{\mathcal P}}
\newcommand{\iI}{{\mathcal I}}
\newcommand{\jJ}{{\mathcal J}}
\newcommand{\uU}{{\mathcal U}}
\newcommand{\sS}{{\mathfrak S}}
\newcommand{\1}{{\mathds 1}}
\newcommand{\Crit}{\operatorname{Crit}}
\newcommand{\GKK}{{G_{\bar{K} : K}}}
\newcommand{\st}{{\text{s.t.}}}
\newcommand{\ra}{\rightarrow}
\newcommand{\Sel}{\text{\normalfont Sel}}
\newcommand{\Sha}{\text{\normalfont Sha}}
\newcommand{\TS}{\text{\normalfont TS}}
\newcommand{\Eb}{\bar{E}}
\newcommand{\EQ}{E(\QQ)}
\newcommand{\cmark}{\textrm{\ding{51}}}
\newcommand{\xmark}{\textrm{\ding{55}}}
\newcommand{\EFp}{{\tilde{E}(\FF_p)}}
\newcommand{\EFt}{{\tilde{E}(\FF_2)}}
\newcommand{\EQp}{{E(\QQ_p)}}
\newcommand{\FF}{\mathbb{F}}
\newcommand{\HH}{\mathbb{H}}
\newcommand{\Tors}{{\text{\normalfont Tors}}}
\newcommand{\parder}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\Zpx}{\mathbb{Z}_p^\times}
\newcommand{\legendre}[2]{(\frac{#1}{#2})}

% colours
\definecolor{red}{rgb}{1,0,0}
\newcommand{\red}[1]{{\color{red}#1}}

\title{
  {The Birch Swinnerton-Dyer Conjecture}\\
}
\author{Felipe Jacob}
\date{5 December 2016}

\tableofcontents
\pagebreak

\maketitle

\section{Elliptic Curve Invariants and the BSD Conjecture}

One of the major topics in modern number theory is the study of rational
solutions to cubic equations in two variables, called elliptic curves.
In this project we will
investigate the relationships between the arithmetic invariants of such
equations and certain analytic functions. Such relationships give rise to
many conjectures with powerful implications, a few of which we will discuss.
We will first define the objects of interest and their invariants, and then
continue with the main calculations.

\subsection{Basic definitions and the group law}

\begin{defn}
  If $K$ is a perfect field,
  we say an \defin{elliptic curve} over $K$ is a smooth cubic projective
  curve $E$ defined over $K$ with at least one rational point $\OO \in E(K)$
  that we call the \defin{point at infinity}.
\end{defn}
With the help of algebraic geometry, we know that such curves can be put
into particularly simple forms.

\begin{prop}
  If $E$ is an elliptic curve over $K$, then it is birationally equivalent
  to the projective completion of the curve
  \begin{equation} \label{eq:weier2}
    E: y^2 + a_1xy + a_3y = x^3 + a_2x^2 + a_4x + a_6
  \end{equation}
  with $a_1, a_2, a_3, a_4 \in K.$
  Furthermore, when $\text{char}(K) \neq 2$ (such as in number fields)
  , the affine variety also can be written as the locus of
  \begin{equation} \label{eq:weier}
    E: y^2 = x^3 + ax^2 + bx + c
  \end{equation}
  with $a, b, c\in K$. This equivalence also takes the rational point $\OO$ to
  $(0 : 1 : 0)$.
  Conversely, an equation of the form \ref{eq:weier} is an elliptic curve if
  \[\Delta(E) = -4a^3c + a^2b^2 + 18abc - 4b^3 - 27c^2 \neq 0,\]
  i.e. if the RHS cubic has no repeated roots.
\end{prop}

\begin{proof}
  \cite[See][Chapter III, pages 42-43]{arithmetic}.
\end{proof}

From now on, unless said otherwise, we will take $K = \QQ$ and $E$ given
by \autoref{eq:weier}.

In this project we will be particularly interested in the following family
of elliptic curves

\begin{defn}
  The family of \defin{quadratic twists of $E : y^2 = x^3 - x$} is the family of curves
  \begin{equation} \label{eq:twist}
    E_n : y^2 = x^3 - n^2 x
  \end{equation}
  where $n$ is a positive integer.
\end{defn}

Elliptic curves are of particular interest primarily because, besides being
a variety, they also form an abelian group. To do this, taking the model of
\autoref{eq:weier}, we define a geometric way to combine two points of $E$.

If $P_1 \neq P_2, P_3$ is the third point in the projective line between $P_1$
and $P_2$. If $P_1 = P_2, P_3$ is the other point in the tangent line of $E$
through $P_1$.
Such points are well defined since finding the third point amounts to solving
a cubic equation with coefficients in $K$ and 2 known roots.
Finally, we set
\[P_1 + P_2 = (x_3, -y_3) \text{ where } (x_3,y_3) = P_1 * P_2.\]
The verification that this is indeed a  group law involves either
extensive case checking or
some complex analysis, which we will not be going into, but see
\cite[129-137]{Granville} for a sketch.

A few explicit formulas that we will use are given in the next proposition. 

\begin{prop}
  If $P_1 = (x_1,y_1), P_2 = (x_2,y_2) \in E, P_1, P_2 \neq \OO$, let
  $$\lambda = \frac{y_1-y_2}{x_1-x_2}.$$
  then we have
  \[P_1 + P_2 = (x_3,-y_3)\]
  where

  \begin{equation} \label{eq:adddiff}
    \begin{split}
      x_3 &= \lambda^2 - a - x_1 - x_2 \\
      y_3 &= \lambda x_3 + (y_1 - \lambda x_1).
    \end{split}
  \end{equation}

  If $P_1 = P_2,$ let
  \[\lambda = \frac{3x_1^2 + 2ax_1 + b}{2y_1}.\]
  we similarly have
  \[P_1 + P_2 = (x_3,-y_3)\]
  where
  
  \begin{equation} \label {eq:addsim}
    \begin{split}
      x_3 &= \lambda^2 - a - 2x_1 \\
      y_3 &= \lambda x_3 + (y_1 - \lambda x_1).
    \end{split}
  \end{equation}
\end{prop}
\begin{proof}
  \cite[See][Chapter 1.7, page 34]{modular}.
\end{proof}

The following results about $\EQ$ were discussed in the course MATH3705,
and their proofs can be found in \cite{rational}, chapters II and III for the
case where \autoref{weier} has at least 1 rational root.

\begin{thm}[Mordell-Weil Theorem]
  The group $\EQ$ is a finitely generated abelian group.
\end{thm}  
\begin{proof}
  \cite[See][Chapter III, pages 63-88]{rational}. Also see the discussion on
  \autoref{sec:applications}.
\end{proof}

\begin{thm}[Nagell-Lutz Theorem] \label{thm:nagelllutz}
  Let
  \[E: y^2 = f(x) = x^3 + ax + b\]
  be an elliptic curve over $\QQ$, and let $\Delta = -4a^3 -27b^2$ be the
  polynomial discriminant of $f(x)$. If $P = (x,y)$ is a point of finite order,
  then either $y = 0$, in which case $P$ has order 2, or we must have $y^2 | \Delta$.
\end{thm}
\begin{proof}
  \cite[See][Chapter II, pages 49-56]{rational}.
\end{proof}

By the classification theorem of finitely generated abelian groups, covered in
MATH3201, we can write
\[\EQ = \Tors(E) \times \ZZ^r\]
for some natural number $r$, where $\Tors(E)$ is the set of points of finite
order in $\EQ$.

\begin{proof}
  \cite[See][Chapter III, pages 63-88]{rational}. See also the discussion on
  \autoref{sec:applications}.
\end{proof}

Finding the number $r$, called the \defin{rank of $E$}, is in some sense the
main problem of the theory of elliptic curves. In the next section we will
develop a different set of tools that will enable us to tackle this problem.

\subsection{The Hasse-Weil L-function}

As with other projective varieties, we can define certain generating functions
that capture the behaviour of $E$ locally, i.e. when $K = \FF_p$.

\begin{defn}
  Let $V$ be a projective variaty.
  The \defin{local zeta function of $V$ at $p$} is the formal power series
  \[Z(V, p, z) = \exp \left( \sum\limits_{r=1}^{\infty} \# V(\FF_{p^r}) \frac{z^r}{r} \right)\]
  where $\# V(\FF_{p^r})$ is the number of points of $V$ in the (unique) field
  of $p^r$ elements.
\end{defn}

\begin{example}
  If $V = (x_0:y_0:z_0)$ is a point, then $\#V(\FF_{p^r}) = 1$, so
  \begin{equation*}
    \begin{split}
      Z(V,p,z) &= \exp \left( \sum\limits_{r=1}^{\infty} \frac{z^r}{r} \right) \\
               &= \exp (-\log (1-z)) \\
               &= \frac{1}{1-z}.
    \end{split}
  \end{equation*}
             
\end{example}

\begin{example}
  If $V = \mathbb{A}^n \subset \mathbb{P}^n$ is the affine
  k$n$-space $, \#(\FF_{p^r})\AA^n = p^r$, so
  \begin{equation*}
    \begin{split}
      Z(\mathbb{A}^n) &= \exp \left(  \sum\limits_{r=1}^\infty \frac{(pz)^r}{r} \right) \\
      &= \exp ( - \log (1-pz) ) \\
      &= \frac{1}{1-pz}
    \end{split}
  \end{equation*}
\end{example}

\begin{example}
  If $V = \mathbb{H}^n \subset \mathbb{P}^n$ is the hiperplane at infinity
  $(x:y:0)$, then $\# \FF_{p^r} (\mathbb{H}^n) = \# \FF_{p^r} (\mathbb{P}^{n-1})
  = 1 + p^r + \cdots + p^{r(n-1)}$. So

  \begin{equation*}
    \begin{split}
      Z(\mathbb{A}^n) &= \exp \left(  \sum\limits_{r=1}^\infty
        \sum\limits_{s=0}^{n-1} \left(  \frac{z^r}{r}  \right) \right) \\
      &= - \sum\limits_{s=0}^{n-1} \log (1 - p^n z) \\
      &= \frac{1}{(1-z) (1-pz) \cdots (1-p^{n-1} z)}
    \end{split}
  \end{equation*}
\end{example}
  
For our family $E_n$ the local zeta function is explicitly given by the
following proposition

\begin{prop}
  If $p \not| \,\, 2n$, then
  \[Z(E_n, p, z) = \frac{1 - 2az + pz^2}{(1-z)(1-pz)} \]
  where $a = \Re(\alpha)$, and $\alpha$ is the complex number
  $i\sqrt{p}$ if $p \equiv 3 \, (4)$ and the unique element of $\ZZ[i]$ of
  norm $p$ congruent to $(\frac{n}{p})$ modulo $2+2i$ if $p \equiv 1 \, (4)$. 
\end{prop}

\begin{proof}
  \cite[See][Chater II-2, pages 59-61]{modular}.
\end{proof}

Encouraged by the local-global principles that work on quadratic curves, we
amalgamate local zeta functions into a single object, hoping it will give us
information about $E(\QQ)$.

\begin{defn}
  The \defin{Hasse-Weil L-function} of $E$ is written
  \begin{equation} \label{eq:lfunction}
    L(E, s) = \frac{\zeta(s) \zeta(s-1)}{\prod_p Z(E, p, p^{-s})}
  \end{equation}
  where $\zeta(s)$ is the Riemann-zeta function. The numerator is introduced
  to clear the denominator of the local zeta functions.
\end{defn}

\subsection{The Regulator}

Going back to considering elliptic curves, the next invariant measures the
rate of growth of the complexity of points as we take higher and higher
multiples of a fixed point. We first need a few definitions.

\begin{defn}
  Let $P = (\frac{a}{b},y) \in E, (a,b) = 1$. The \defin{height of $P$} is
  defined to be the number
  \[ H(P) = \max \{|a|, |b| \}.\]
\end{defn}

It turns out that taking an integer multiple of a point of $E$ has an
exponential effect on its height, so we prefer to work with the logarithmic
height $h(P) = \log (H(P))$. To better yet capture the now almost linear
behaviour of $h(P)$, we define

\begin{defn}[Neron-Tate height]
  Let $P \in E$. Then the \defin{Neron-Tate height of $P$} is defined to be
  \[ \hat{h}(P) = \lim\limits_{n \rightarrow \infty} \frac{\log H(2^n P)}{4^n}. \]
\end{defn}

It turns out that the Neron-Tate height enables us to define an inner product
on $\EQ$.

\begin{defn}[Neron-Tate pairing]
  Let $P, Q \in \EQ$. Then the pairing
  \[ \langle P,Q \rangle =
    \frac{1}{2} \left( \hat{h}(P+Q) - \hat{h}(P) - \hat{h}(Q) \right)\]
  is an inner product on $\EQ$ called the \defin{Neron-Tate pairing}.
\end{defn}

We will use the Neron-Tate pairing to define an invariant that plays a role
similar to that of the determinant of a linear map in measuring the size of
the image of the unit cube.

\begin{defn}[Regulator]
  Let $P_1, \dots P_r$ be a basis for $\frac{{\EQ}}{\Tors (E)}$.
  Then the \defin{regulator of $\EQ$} is the number
  \[R_E = \det ( \langle P_i, P_j \rangle)_{1\leq i, j \leq r}.\]
\end{defn}

The importance of the regulator is justified by the following proposition

\begin{prop}
  Let $r$ be the rank of $\EQ$.

  If $r = 0$ then $\# \EQ = \# \Tors(E)$.

  If $r \geq 1$ then, as $x \rightarrow \infty$,
  \[\# \{P \in \EQ \, | \, \hat{h}(P) \leq x \} \approx \frac{\#
      \Tors(E)}{R_E^{1/2}}
    B_r x^{r/2}\]
  where $B_r$ is the volume of the $r$-dimensional unit ball.
\end{prop}
\begin{proof}
  \cite[See][Chapter 13.7, page 127]{Granville}.
\end{proof}
  

\begin{remark}
  To check that all definitions given in this section behave precisely as
  stated, see \cite[Chapter 13.7-8, pages 123-127]{Granville}.
\end{remark}
  

\subsection{The Period and Sha}

Before we are ready to state the main conjecture, we need to define a few
other invariants of $E$. 

\begin{defn}[Real Period] 
  The \defin{real period $\Omega_{E_n}$ of $E_n$} is the real number
  \[ \Omega_{E_n} = \frac{1}{\sqrt{n}} \int_{E(\RR)} \frac{dx}{2y} =
    \frac{1}{2 \sqrt{n}} \int_1^\infty \frac{dx}{\sqrt{x^3-x}}.\]
  The last integral can't be evaluated in terms of elementary functions,
  but its value is a real number $p \approx 2.622 \dots$.
\end{defn}
\begin{remark}
  This is not the complete definition, but it suffices for our family $E_n$.
\end{remark}

The next invariant is the \defin{Tate Shafarevich group $\Sha(E)$}, which will
be defined in \autoref{defn:sha}. It is an abelian group which intuitively measures
the hardness of working out the rank of $E$ by local methods, and is conjectured
to be finite.

\subsection{Tamagawa Numbers}

Finally, the product in \autoref{eq:lfunction} doesn't really capture any information
about the primes where the curve is singular. The arithmetic data at those
primes enters the Birch Swinnerton-Dyer conjecture by means of the Tamagawa
Numbers.
Again let
$$ E_n : y^2 = x^3 - n^2 x. $$
If $p \not| \,\, \Delta E = 4n^2$ then the reduction $\tilde{E} : y^2 \equiv x^3 - n^2 x \,
(p)$ is
also an elliptic curve. We have

\begin{prop}[Reduction Modulo p]
  If $p \not| \,\, \Delta(E)$, the reduction map
  $$E(\QQ) \rightarrow \tilde{E}(\FF_p)$$ is a group homomorphism.
\end{prop}
\begin{proof}
  \cite[See][Chapter IV, pages 121-123]{rational}.
\end{proof}

If $p | \Delta E$ then $\tilde{E}(\FF_p)$ is not a group, but
\[
  \tilde{E}(\FF_p)_{ns} := \{P \in \tilde{E}(\FF_p) \,|\, P \text{ is nonsingular}\}
  \]
is still a group.

Looking at $E$ in the completion $\QQ_p$ we still have a map
\[\EQp \rightarrow \EFp\].
If we let $\EQp_0$ be the preimage of $\EFp_{ns}$ we get a group homomorphism
\[ \EQp_0 \rightarrow \EFp_{ns} \].

\begin{defn}
  The Tamagawa Number of $E$ at $p$ is the number
  $$c_p = \left| \frac{\EQp}{\EQp_0}
  \right|.$$
  If $p \not| \,\, \Delta$ then $c_p = 1$.
\end{defn}  
  
\subsection{The BSD Conjecture and Tunnell's Theorem}

During the 1960s, Bryan Birch and Peter Swinnerton-Dyer formulated, based
on numerical evidence, an influential conjecture relating the Hasse-Weil
L-function to the arithmetic invariants of $E$.

\begin{conj}[Birch Swinnerton-Dyer Conjecture] \normalfont
  \textit{The Hasse-Weil L-function $L(E,s)$ can be written as
  \[L(E,s) = C (s-1)^r + O((s-1)^2)\] where}
  \[C = \frac{|\text{Sha}(E)| \, \Omega_E R_E}{|E(\QQ)_{\text{tors}}|^2} \prod_p c_p\]
\end{conj}

In particular, near 1, it predicts the value of the integer
\[0^r \cdot | \Sha(E)| \prod_p c_p .\]

The BSD conjecture is particularly powerful to gather information about
parametrised families of elliptic curves, since we can then form a parametric
family of L-functions and hope that by analysing those we can recover useful
arithmetic information.
In the case of our family $E_n$, the following remarkable result, proven using
the machinery of modular forms, shows that
$L(E_n,s)$ takes a particularly simple form.

\begin{thm}[Tunnell's Theorem]
  \begin{equation} \label{eq:tunnell}
    L(E_n,1) = \begin{cases}
      \frac{1}{2}\Omega_{E_n}a^2_n & \text{ if $n$ is odd} \\
      \Omega_{E_n}a'^2_{n/2} & \text{ if $n$ is even}
    \end{cases}
  \end{equation}

  where the $a_i, a'_i$ are coefficients of the fourier expansions of the
  functions $f, f'$ given by
  \[f(z) = \sum\limits_{m=-\infty}^\infty a_m q^m
    = (\Theta(z) - \Theta(4z)) (\Theta(32z)-\frac{1}{2} \Theta(8z)) \Theta(2z)\]
  and
  \[f'(z) = \sum\limits_{m=-\infty}^\infty a'_m q^m =
    (\Theta(z) - \Theta(4z)) (\Theta(32z)-\frac{1}{2} \Theta(8z)) \Theta(4z)\]
  with $q = e^{2\pi i z}$.
  
  Here $\Theta(z)$ is the theta-function given by
  \[ \Theta(z) = \sum\limits_{n = -\infty}^{\infty} q^{n^2} \text{ where } q =
    e^{2\pi iz}.\]
\end{thm}

\begin{proof}
  \cite[See][pages 325-328]{Tunnell}. Also \cite[pages 212-222]{modular}
  discusses the proof extensively.
\end{proof}
  
In this project we will take advantage of the fact that the coefficients of
$L(E_n,1)$ are given by relatively simple arithmetic functions, and use that
to verify the BSD conjecture for the family $E_n$.

To do this we will first compute all the invariants of $E_n$ as well as
possible, and then find a simple form for the coefficients of $f$ and $f'$ modulo
a high enough power of 2. This will enable us to predict the rank of $E_n$ as
$n$ ranges over the prime numbers.

\section{Galois Cohomology}

\subsection{Group Cohmology}

Let $G$ be a finite group. We define the \defin{group ring $\ZZ[G]$} to
be the ring of formal sums
\[ \ZZ[G] = \big\{ \sum\limits_{i=1}^{|G|} x_i \, | \, x_i \in \ZZ, g_i \in G \big\}\]
with identity $1 \cdot e_G$ and addition and multiplication defined by
\[\sum\limits_{i=1}^{|G|} x_ig_i + \sum\limits_{i=1}^{|G|} y_ig_i =
\sum\limits_{i=1}^{|G|} (x_i+y_i)g_i\]
and \[(\sum\limits_{i=1}^{|G|} x_ig_i) \cdot (\sum\limits_{i=1}^{|G|} y_ig_i) =
\sum\limits_{t=1}^{|G|} \sum\limits_{i+j = t} x_iy_jg_ig_j \].
We say an abelian group $A$ is a \defin{$G$-module} if it is a module
for the ring $\ZZ[G]$. This is a commutative module if $G$ is also abelian.

We define the
first and second cohomology groups of $A$ by
\[H^0 (G, A) = \text{Hom}_{\ZZ[G]}(\ZZ, A)\] and
\[H^1 (G, A) = \text{Ext}^1_{\ZZ[G]} (\ZZ, A)\]
where $\ZZ$ is considered the trivial $G$-module where $g x = x$ for every
$x \in \ZZ, g \in G$.
Let $\phi : \ZZ \rightarrow A$ be a module homomorphism. Then
\[\begin{split} \phi(1) &= \phi(g \cdot 1) \,\,\,\, \forall g \in G \\
    &= g \cdot \phi(1) , \end{split}\]
so $\phi(1) \in A^G = \{x \in A \, | \, gx = x, \forall g \in G\}$, the set
of elements at which $G$ acts trivially. Since a $\ZZ$ homomorphism is
completely determined by the image of 1, we can set
\[ H^0 (G, A) = \text{Hom}_{\ZZ[G]}(\ZZ, A) = A^G .\] 

We can also define the first cohomology group as
\[H^1(G, A) = \frac{Z^1(G,A)}{B^1(G,A)}\]
where
\[Z^1(G,A) = \{ \phi : G \rightarrow A \, | \phi(gh) = \phi(g) + g \phi(h)\}\]
\[B^1(G,A) = \{ \delta \in Z^1 \, | \, \exists a \in A \,\,\text{such that}\,\, \delta(g)
  = ga - a , \forall g \in G\}\]

\begin{prop}
  With this setup, we can take a short exact sequence of $G$-modules
  \[ 0 \rightarrow A \rightarrow B \rightarrow C \rightarrow 0\]
  and form the long exact sequence
  \[ 0 \rightarrow H^0(G, A) \rightarrow H^0(G,B) \rightarrow H^0(G,C)
    \rightarrow H^1(G, A) \rightarrow H^1(G,B) \rightarrow H^1(G,C) \]
\end{prop}

\subsection{Galois Cohomology}

We can now use the machinery of group cohomology to study number fields.
Let $L, K$ be number fields and $L : K$ a finite degree Galois
extension with Galois group $G_{L:K}$.
A Galois module $A$ is a module over $G_{L:K}$.

\begin{example}
  We can consider the Galois modules $A = L \simeq K[G], $ or $A =
  L^{\times}$ where $L^{\times}$ is the multiplicative group of $L$.
\end{example}


\begin{defn}
  The \defin{zeroth and first Galois cohomology groups} are written
  \begin{equation*}
    \begin{split}
      H^0(L:K, A) &= H^0(G_{L:K}, A) = A^{G_{L:K}} \\
      H^1(L:K, A) &= H^1(G_{L:K}, A)
     \end{split}
   \end{equation*}
\end{defn}

\begin{example}
  If $E$ is an elliptic curve over $K$ then $A = E(L)$ is a Galois module,
  since the addition formulas are rational over $K$.

  If $K = \QQ$, we have $H^0(\QQ,E(L)) = E(L)^{G_{L:\QQ}} = E(\QQ)$.
  From now on we will write $H^1(\QQ, E)$ for the group $H^1(\QQ, E(\bar{\QQ}))$.
\end{example}

The following result gives an important terminating condition for the
long exact sequences:

\begin{thm}[Hilbert's Theorem 90]
  $  H^1(L : K, L^{\times}) = 0$
\end{thm}
\begin{proof}
  \cite[See][Chapter X, page 150]{cohomology}
\end{proof}

In what follows we will take $L = \bar{K}$, the algebraic closure of $K$ and
$G_K = G_{\bar{K}:K}$ its Galois group. This extension is usually infinite, so
it will be necessary to make amendmends to the previous defintions.

\begin{defn}
  A $G_K$-module $A$ is called a continuous $G_K$-module if for all $g \in G_K, a \in A$,
  there exists a finite Galois extension $L:K$ such that $g(a)$
  depends only on the image of $g$ in $G_{L:K}$.
\end{defn}

\begin{example}
  $\bar{K}$ and $ \bar{K}^{\times}$ are continuous $G_K$-modules.
\end{example}

\begin{lemma}
  $E(\bar{K})$ is a continuous $G_K$-module.
\end{lemma}
\begin{proof}
  Note that if $P = (x,y) \in E(\bar{K})$ and $L$ the field generated
  by the coordinates of $P$, then $P \in E(L)$ and $L$ is finite. This is
  because $x, y$ satisfy an algebraic equation over $K$. But then
  $g P = P, \forall g \in G_{\bar{K} : L}$, as wanted.
\end{proof}
  
To form cohomology groups, set
\[H^1(K,A) = \frac{Z^1_{\text{cts}}(K,A)}{B^1(K,A)}\]
where
\[Z^1_{\text{cts}} = \{\phi : G_K \rightarrow A \, | \, \exists L : K
  \text{ such that } \phi(g) \text{ depends only on } g \text{ modulo } L\}.\]

If we have a short exact sequence of continuous $G_K$-modules
\[ 0 \ra A \ra B \ra C \ra 0\]
this gives a long exact sequence of Galois cohomology groups
\[0 \ra A^{G_K} \ra B^{G_K} \ra C^{G_K} \ra H^1(K,A) \ra H^1(K,B) \ra H^1(K,C).\]


\subsection{Applications to Elliptic Curves} \label{sec:applications}
A crucial step in the proof of the Mordell-Weil theorem, enough to show that
the rank of an elliptic curve over $\QQ$ is finite, is the study of the size
of the quotient $E(\QQ) / 2 E(\QQ)$. In curves with at least one 2-torsion
point, this can be done with the help of an isogeny.

Let $$E : y^2 = x^3 + ax^2 + bx$$ be an elliptic curve over $\QQ$. We know $E$
has the rational points $\OO, T = (0,0)$.

We also consider the curve
\[ \bar{E} : y^2 = x^3 + \bar{a}x^2 + \bar{b}x \]
where $\bar{a} = -2a$ and $\bar{b} = a^2 - 4b$. Repeating this process yields
the curve
\[ \bar{\bar{E}} : y^2 = x^3 +  4ax^2 + 16bx\]
which is birationally equivalent to $E$ by the transformation $y \mapsto 8y,
x \mapsto 4x$.

\begin{prop}
  Let $E, \bar{E}$ be as above. The maps $\phi : E \rightarrow \bar{E}$ and
  $\psi : \bar{E} \rightarrow E$ defined by
  \[\phi(P) =
    \begin{cases}
      (\frac{y^2}{x^2}, \frac{y(x^2-b)}{x^2}), & \text{ if } P \neq \OO, T \\
      \bar{\OO}, & \text{ if } P = \OO \text{ or } P = T
    \end{cases}\]
  and
  \[\psi(P) =
    \begin{cases}
      (\frac{\bar{y}^2}{4\bar{x}^2}, \frac{\bar{y}(\bar{x}^2-\bar{b})}{8\bar{x}^2}),
      & \text{ if } P \neq \bar{\OO}, \bar{T} \\
      \bar{\OO}, & \text{ if } \bar{P} = \bar{\OO} \text{ or } \bar{P} = \bar{T}
    \end{cases}\]
  are elliptic curve isogenies, $\text{Ker}(\phi) = \{\OO, T\}$ and
  \[ \psi \circ \phi (P) = 2P , \text{ for all points } P \in E.\]
\end{prop}
\begin{proof}
  \cite[See][Chapter 4, page 79]{rational}.
\end{proof}

\begin{lemma} \label{lemma:rankformula}
  If $E / \psi(\bar{E}))$ and $\bar{E} / \phi(E)$ are finite, then so is $E/2E$.
  In fact, the rank $r$ of $E$ satisfies
  \[2^r = \frac{\#E/\psi(\Eb) \cdot \#\Eb/\phi(E)}{4}\]
\end{lemma}
\begin{proof}
  \cite[See][Chapter 4, page 83]{rational}.
\end{proof}

\begin{defn}
  From now on, for any morphism $\phi : A \ra B$, we
  will write $\text{Ker}(\phi) = A[\phi]$.
\end{defn}

We are thus led to consider the quotient $E(\QQ) / \psi(\bar{E}(\QQ))$ (the
other one can be treated identically).

By the proposition, we have a short exact sequence of $G_{\QQ}$-modules
\[ 0 \rightarrow \{\OO, T\} \rightarrow \bar{E}(\bar{\QQ}) \xrightarrow[]{\psi}
  E(\bar{\QQ})
  \rightarrow 0\]
and $\{\OO, T\} \simeq \ZZ/2\ZZ$.

Taking Galois cohomology we get the long exact sequence
\[ 0 \rightarrow \ZZ / 2\ZZ \rightarrow \bar{E}(\QQ) \xrightarrow[]{\psi} E(\QQ)
  \rightarrow H^1(\QQ, \ZZ/2\ZZ) \rightarrow H^1(\QQ, \bar{E}) \xrightarrow{H^1(\psi)}
  H^1(\QQ, E)\]
This in turn gives us the short exact sequence
\[ 0 \rightarrow \frac{E(\QQ)}{\psi(\bar{E} (\QQ))} \rightarrow
  H^1(\QQ, \ZZ / 2\ZZ) \rightarrow H^1(\QQ, \bar{E}(\QQ))[\psi] \rightarrow 0\]

where $H^1(\QQ,\bar{E}(\QQ))[\psi] = (H^1(\psi))^{-1}.$ \vspace{3mm}

To get the order of $E(\QQ) / \psi(\bar{E}(\QQ))$ we need to investigate the group
$H^1(\QQ, \ZZ/2\ZZ)$.

\begin{prop}
  There exists a canonical isomorphism so that
  \[H^1(\QQ, \ZZ/2\ZZ) \simeq \QQ^{\times} / (\QQ^{\times})^2\]
\end{prop}
\begin{proof}
Consider the exact sequence of Galois modules
\[0 \rightarrow \mu_2 \rightarrow \bar{\QQ}^{\times} \xrightarrow[]{2} \bar{\QQ}^{\times} \ra
  \, 0 \]

Taking cohomology gives the long exact sequence
\[ 0 \ra \mu_2 \ra \bar{\QQ}^{\times} \xrightarrow[]{2} \bar{\QQ}^{\times} \ra H^1(\QQ, \ZZ/2\ZZ)
  \ra H^1(\QQ, \bar{\QQ}^{\times})\]
and $H^1(\QQ, \bar{\QQ}^{\times}) \simeq 0$ by Hilbert's Theorem 90. Thus,
\[H^1(\QQ, \ZZ/2\ZZ) \simeq \QQ^{\times}/(\QQ^{\times})^2. \]
\end{proof}

\subsection{The Selmer and Tate-Shafarevich Groups}

In the effort to understand $E(\QQ)/2E(\QQ)$, we were led to consider the quotient
$E(\QQ) / \psi(E(\QQ))$. Our application of Galois cohomology showed that this
group is a subsgroup of the multiplicative group of rationals modulo squares
$\QQ^{\times} / (\QQ^{\times})^2$. This group, in turn, can be studied by means
of local method.

\begin{defn}
  A \defin{place} $\nu$ is either a prime number $p$ or $\infty$. $\QQ_\nu$ then is
  either the field of $p$-adic numbers if $\nu = p$ or $\RR$ if $\nu = \infty$.
\end{defn}

\begin{defn}
  If $\phi: A \rightarrow B$ is a homomorphism, then write $A[\phi]$ for the
  kernel of $\phi$.
\end{defn}

There is then a natural inclusion $\QQ \ra \prod\limits_\nu \QQ_\nu,
x \mapsto (x, x, \dots)$ since $\QQ \subset \QQ_{\nu}$ canonically for each $\nu$.

\begin{tikzcd}
  0 \arrow[r] &
  E(\QQ)/\psi(E(\QQ)) \arrow[r] \arrow[d]&
  \QQ^{\times}/(\QQ^{\times})^2 \arrow[r] \arrow[d] &
  H^1(\QQ, \bar{E})[\psi] \arrow[r] \arrow[d] &
  0 \\
  0 \arrow[r] &
  \prod\limits_{\nu} E(\QQ_\nu) / \psi(E(\QQ_\nu)) \arrow[r] &
  \prod\limits_\nu(\QQ_\nu^{\times}/(\QQ_\nu)^{\times})^2 \arrow[r] &
  \prod\limits_\nu H^1(\QQ_\nu, \bar{E})[\psi] \arrow[r] &
  0
\end{tikzcd}

We are now ready to make the following definition

\begin{defn}[Selmer Group]
  The Selmer group of the elliptic curve $E$ is defined
  $$\Sel_\psi = \text{Ker}\big((\QQ^{\times}/(\QQ^{\times})^2 \ra
  \prod\limits_\nu H^1(\QQ_\nu, \bar{E})[\psi]\big)$$
\end{defn}

This group is important in rank computations primarily because it is effectively
computable. To understand $\EQ/\psi(\Eb(\QQ))$ fully, we also need

\begin{defn}[Tate-Shafarevich Group] \label{defn:sha}
  The Tate-Shafarevich group of the elliptic curve $E$ is defined
  $$ \Sha(\bar{E} / \QQ) = \text{Ker} \big((H^1(\QQ, \bar{E}) \ra \prod\limits_\nu H^1 (\QQ_\nu,
  \bar{E})[\psi]\big) $$
\end{defn}

Finally, we have the important short exact sequence

\[ 0 \ra \frac{E(\QQ)}{\psi(\bar{E}(\QQ))} \ra \Sel \ra \Sha(\bar{E}/\QQ)[\psi] \ra 0\]

If $\Sha(\Eb/\QQ)[\psi] \simeq 0$, $Sel \simeq \EQ/\psi(\Eb(\QQ))$. By playing
the same game with the isogeneous curve $\Eb$, if $\Sha(E/\QQ)[\phi] \simeq 0$,
we also know $\Eb(\QQ)/\phi(\EQ)$ and can use \ref{lemma:rankformula} to compute
the rank of $E$. 

\begin{remark}
  The map $\alpha \EQ / \psi(\bar{E}(\QQ)) \ra \QQ^\times / (\QQ^\times)^2$ has been
  explicitly computed in \cite{rational} for curves with a 2-torsion point, and
  has been shown to be the map $(x,y) \mapsto x \mod (\QQ^\times)^2$.
  Furthermore, \cite{rational} also shows that the image of $\alpha$ is
  contained in the subgroup
  \[\{\pm 1, \pm p_1^{e_1}, \dots, \pm p_t^{e_t} \}\]
  where the $p_i$ are the prime factors of $\Delta(E)$ and $e_i =$ 0 or 1.
\end{remark}

\pagebreak

\section{Calculations}

\subsection{Introduction}

From Tunnell's theorem we know that $L(E_n,s)$ has a particularly simple
form in terms of Theta functions. In this subsection we'll show that they
can be used to predict whether $0^r \#\text{Sha}(E)$ is even or odd, and that
this agrees with the BSD conjecture.


\subsection{Coefficients of Theta Series}
Tunnell's theorem leads us to consider the quantities 
\begin{equation*}
  \begin{split}
    A_n &= \#\{(x,y,z) \,|\, n = 2x^2 + y^2 + 32z^2\} \\
    B_n &= \#\{(x,y,z) \,|\, n = 2x^2 + y^2 + 8z^2\} \\
    C_n &= \#\{(x,y,z) \,|\, n = 8x^2 + 2y^2 + 64z^2\} \\
    D_n &= \#\{(x,y,z) \,|\, n = 8x^2 + 2y^2 + 16z^2\}
  \end{split}
\end{equation*}

depending on whether $n$ is odd or even. For our calculations we'll
need to compute $A_n - \frac{1}{2}B_n$ and $C_n - \frac{1}{2}D_n$ modulo 4.

\begin{thm}
  $2A_p - B_p \equiv \begin{cases} 0, & p \equiv 1, 5, 7 \, (8) \\
    2, & p \equiv 3 \, (8) \end{cases}
  \, (4)$
\end{thm}
\begin{proof}
  In computing $A_P$ and $B_P$ we only need to consider solutions
  where at least 1 of $x, y, z$ is 0, since if neither is 0, all of $\pm x, \pm y, \pm z$
  are solutions, and hence they together don't make a contribution to the total
  number of solutions modulo 8. Furthermore, since we only need to consider $A_n$
  modulo 4, we can also ignore solutions where exactly 1 of $x, y z$ are 0. But
  there are no remaining solutions since p is prime and if 2 of $x, y, z$ are 0 we
  arrive at the contradiction $x^2 = p$, so we have $A_p \equiv 0 \, (4)$.

  With this we're left to consider $\frac{1}{2}B_p \, (4)$, or $B_p \, (8)$. Again we can
  ignore solutions where all of $x, y, z$ are 0, so we have, by inclusion-exclusion

  \( A_p \equiv \#\{ 2x^2 + y^2 = p\} + \#\{y^2 + 8z^2 = p\} + \#\{2x^2 + 8z^2 = p\} \\
  \equiv \#\{ 2x^2 + y^2 = p\} + \#\{y^2 + 8z^2 = p\} \, (8)\)
  since p is odd. To find the remaining quantities we need some algebraic number
  theory.

\begin{lemma}
  For $p$ odd, $\#\{2x^2 + y^2 = p\} = \begin{cases} 4,
    p \equiv 1 \, (8) \\
    1, p \equiv 3 \, (8) \\
    0, else \end{cases}$
\end{lemma}
\begin{proof} We must have $2x^2 + y^2 \equiv 0 \, (p)$, so we only have solutions if
$(\frac{-2}{p}) = 1$, or equivalently if $p \equiv 1, 3 \, (8)$. Since
$\ZZ[\sqrt{2}]$ is a PID, if $p \equiv 1 \, (8), p = \pi \bar{\pi}$ for some
prime $\pi = x + y \sqrt{2}$ where $x^2 + 2y^2 = p$, so $x$ is odd and $x^2
\equiv 1 \, (8)$
If $y$ is also odd, $1 + 2y^2 \equiv 1 \, (8) \implies y^2 \equiv 1 \, (8)$, and
we have $x^2 + 2y^2 \equiv 3 \, (8)$, a contradiction.
If $y = 2k$ is even, we have $x^2 + 2y^2 = x^2 + 8y^3$ 
\end{proof}

To conclude the proof of the theorem, we can deduce from the lemma that
\begin{itemize}
  \item If $p \equiv 1 \, (8), A_p \equiv 4+4 \equiv 0 \, (8)$.
  \item If $p \equiv 3 \, (8), A_p \equiv 4 + 0 \equiv 4 \, (8)$.
  \item If $p \equiv 5, 7 \, (8), A_p \equiv 0 + 0 \equiv 0 \, (8)$.
\end{itemize} 
Looking at $A_p - \frac{1}{2} B_p$ modulo 4 gives the result.
\end{proof}
\subsection{Selmer Group}

Now we proceed in the other direction, and examine the expected rank of the
curve by studying its arithmetic invariants. We'll first compute the Selmer
group of $E_p$ and $\Eb_p$.

\begin{prop}
  $\Sel(E_p)$ is a subgroup of the multiplicative group
  $ \{ \pm 1, \pm p \}$, and $d_1 \in \Sel$ if and only if the equation
  \begin{equation} \label{eq:hom}
    N^2 = d_1 M^4 + \frac{p^2}{d_1}e^4
  \end{equation}
  has a solution in $\QQ_p$ for all $p$.
  Similarly, $\Sel(\Eb_p)$ is a subgroup of $\{\pm 1, \pm 2, \pm p, \pm 2p\}$
  consisting of elements $d_1$ at which \ref{eq:hom} has a p-adic solution for
  all prime numbers.
\end{prop}
Proof: See \cite{rational}

We will compute $\Sel$ by looking at the equation modulo different primes.
There will be 3 cases to consider: 2, $p$, and any prime $l \neq p$.

\subsubsection{l-adic case}

In order to work out if equation \ref{eq:hom} has a solution in $\QQ_p$,
we will first show it has a solution 
in $\ZZ/p\ZZ$, and then lift this solution to $\QQ_p$ using:

\begin{prop}[Hensel's Lemma]
  Let $f \in \ZZ_p[X_1,\dots,X_m], x = (x_i) \in (\ZZ_p)^m, n, k \in \ZZ$ and
  $j$ an integer such that $0 \leq j \leq m$. Suppose that $0 < 2k < n$ and that
  \[ f(x) \equiv 0 \, (p^n) \text { and } \nu_p
    \big(\frac{\partial f}{\partial X_j} (x) \big) = k.\]
  Then there exists a zero $y$ of $f$ in $(\ZZ_p)^m$ which is congruent to $x$
  modulo $p^{n-k}$.
\end{prop}

To show existence of local solutions, we will need the following results: 

\begin{prop} 
  The number of solutions $N_p$ to the equation
  \[a_1x_1^{l_1} + \cdots a_rx_r^{l_r} \equiv 0 \, (p)\]
  satisfies
  \begin{equation} 
    |N - p^{r-1}| \leq M(p-1)p^{(r/2)-1}
  \end{equation} 
  where $M$ is the number of $r$-tuples
  of characters \linebreak
  $\chi_1, \dots , \chi_r$
  where $\chi_i^{l_i} = \varepsilon, \chi_i \neq \varepsilon$ for
  $i = 1, \dots, r$ and $\chi_1 \chi_2 \cdots \chi_r = \varepsilon$.
\end{prop} \label{prop:countsols}
Proof: \cite[See][]{classical}.

\begin{prop}[Chevalley Warning Theorem]
  Let $f \in K[X_1, \dots , X_n]$ be a homogeneous polynomial
  in $n$ variables such that $deg f \leq n$. Then $f$ has a nontrivial 0.
\end{prop}

\begin{proof}
  \cite[See][Chapter 1, page 5]{Serre}
\end{proof}

We can apply these results to show that equation \ref{eq:hom} has solutions
in $\ZZ/p\ZZ$.

\begin{lemma}
  If $l \neq 2, p$ is prime, then \ref{eq:hom} has a solution in $\QQ_l$.
\end{lemma}
Proof: We are looking at the number of solutions to
\[ N^2 - d_1M^4 - \frac{p^2}{d_1}e^4 \equiv 0 \, (l)\]
where $d_1 = \pm 1, \pm 2, \pm p, \pm 2p$. Since none of $1, d_1$ and
$\frac{p^2}{d_1}$ are divisible by $l$, we may apply
proposition \ref{prop:countsols}.

If $l \equiv 1 \, (4)$, there are 2 characters modulo
 $l$ of order dividing 4. The primitive quartic
characters $\chi^{\pm 1}$ and the quadratic character $\chi^2$ where $\chi^2(n) =
(\frac{n}{p})$. Thus, $M$ is the number of tuples $\chi, \chi^a, \chi^b,
a,b = \pm 1, 2$ where $\chi \chi^a \chi^b = \varepsilon$, so $M = 2$. Plugin
into the bound given by proposition \ref{eq:countsols} we get
\[|N_l - l^{r-1} | \leq 2(l-1) l^{(3/2)-1}.\]
The equation \ref{eq:hom} will have a nontrivial solution if $|N-p^2| \leq
p^2-2$, but
\[2(p-1)p^{1/2} \leq p^2 - 2\]
is satisfied for all $p \geq 3$.
If $l \equiv 3 \, (4)$, the values taken by $x^4$ are the same as those taken
by $x^2$, so $N_l$ is also the number of solutions to
\[N^2 - d_1M^2 - \frac{p^2}{d_1} e^2 \equiv 0 \, (l),\]
which has a nontrivial solution by the Chevalley Warning theorem. \qedhere

\begin{thm}[Existence of l-adic Solutions]
  For $a, b \not\equiv 0 \, (l)$, there is always a triple
  $x, y, z \in \QQ_p^{\times}$ such that $x^2 = ay^4 + bz^4$.
\end{thm}
Proof: Let $f(x,y,z) = x^2 - ay^4 - bz^4$. Then $f$ has a nontrivial root
$(X,Y,Z)$ in $\ZZ/p\ZZ$ by the previous results, so we may assume for instance
that $X \not\equiv 0 \, (p)$.
Since $l$ is odd, neither partial derivative increases the $l$-adic valuation
of $f$, so, for instance, $\nu_l(\frac{\partial f(X,Y,Z)}{\partial x}) =
\nu_l(2X) = 0$ and $f(X,Y,Z) \equiv 0 \, (p)$, so $\nu_p(f(X,Y,Z)) \geq 1$.
Thus, Hensel's lemma applies and we get a solution $\bar{X}, \bar{Y}, \bar{Z}
\in \QQ_p$. \qedhere

\subsubsection{p-adic case}
Now there are a finite number of equations to check. We will proceed case by
case. Remeber we're trying to find solutions in $\QQ_p$ to the equations
\begin{equation} \label{eq:homcurve}
  N^2 = d_1 M^4 - \frac{p^2}{d_1}e^4
\end{equation}
and
\begin{equation} \label{eq:isocurve}
  N^2 = d_1 M^4 + \frac{4p^2}{d_1}e^4
\end{equation}
corresponding to the curves $E_p$ and $\Eb_p$.

\begin{thm}
  The equations \ref{eq:homcurve} have a nontrivial solution in $\QQ_p$. In fact,
  they have solutions in $\QQ$.
\end{thm}
Proof:
\begin{itemize}
\item If $d_1 = -1$, we have the rational solution $(p, 0, 1)$.
\item If $d_1 = p$, we have the rational solution $(0, 1, 1)$.
\item If $d_1 = -p$, we have the rational solution $(0, 1, 1)$.
\end{itemize}
\qedhere

\begin{thm}
  The equations \ref{eq:isocurve} have a nontrivial solution in $\QQ_p$ subject
  to the following conditions: 

  $\begin{tabu}{l*{2}{c}r}
    d_1 & \text{condition} \\
    \hline
    1 & \cmark \\
    2 & p \equiv \pm 1 \, (8) \\
    p & p \equiv 1 \, (4) \\
    2p & p \equiv 1 \, (8) \\
    -1 & p \equiv 1 \, (4) \\
    -2 & p \not\equiv 5 \, (8) \\
    -p & p \equiv 1 \, (4) \\
    -2p & p \equiv 1 \, (8)
  \end{tabu}$
\end{thm}
\begin{proof} Proceeding case by case:
  \begin{itemize}
  \item If $d_1 = -1, N^2 \equiv -M^4 \, (p^2)$, so if $M \not\equiv 0 \, (p^2),
    -1 \equiv (\frac{N}{M^2})^2 \, (p)$, which has a solution if and only if
    $p \equiv 1 \, (4)$. If $M \equiv 0 \, (p^2), M = p^2M'$, so $N$ is also
    divisble by $p$, and we don't have a nontrivial solution in $\ZZ/p\ZZ$.
  \item If $d_1 = 2, N^2 \equiv 2M^4 \, (p^2)$, and by a similar argument we must
    have $(\frac{2}{p}) = 1$, so we have a solution if and only if $p \equiv \pm 1
    \, (8)$.
  \item If $d_1 = p, N^2 \equiv 0 \, (p)$, so $N = pN'$ and $pN'^2 = M^4 + 4e^4$.
    Since $M, e$ cannot be divisible by $p$, we must have
    $-4 \equiv (\frac{M}{e})^4 \,\, (p)$. If $p \equiv 3 \, (4)$, this is
    equivalent to $-4 \equiv X^2 \, (p)$, which is a contradiction.
    Conversely, if $p \equiv 1 \, (8),$ 1 is a 4th power and $ (\frac{2}{p}) = 1$,
    so $-4 = (\sqrt{2} \cdot \sqrt{-1})^4$. If $p \equiv 5 \, (8)$, let $\chi$ be
    a primitive quartic character. Then $\chi(-4) = \chi(-1)\chi(2)^2
    = \chi(-1) (\frac{2}{p}) = (-1) \cdot (-1) = 1$, since -1 is not a fourth
    power. Thus, we have a solution if and only if $p \equiv 1 \, (4)$.
  \item If $d_1 = 2p, N^2 \equiv 0 \, (p)$, so $N = pN'$ and $pN'^2 = 2M^4 +
    2e^4$. Again, since we have$M, e \not\equiv 0 \, (p), -1 \equiv (\frac{M}{e})^4 \,
    (p)$, so we must have $p \equiv 1 \, (8)$.
  \item If $d_1 = -2$, a similar argument shows we must have $(\frac{-2}{p})=1$,
    so $p \not\equiv 5 \, (8)$.
  \item If $d_1 = -p$, again we have solutions if and only if -4 is a 4th power,
    and then $p \equiv 1 \, (4)$. 
  \item If $d_2 = -2p$, again we have solutions if and only if $p \equiv 1 \, (8)$.
  \end{itemize} \qedhere
\end{proof}

\subsubsection{2-adic case}
Finally, we consider the 2-adic solutions. Remembering \ref{eq:homcurve} has
rational solutions, we only need to consider the isogeneous curve.

\begin{thm}
  The equations \ref{eq:isocurve} have a nontrivial solution in $\QQ_2$ subject
  to the following conditions:
  
  $\begin{tabu}{l*{2}{c}r}
    d_1 & \text{condition} \\
    \hline
    1 & \cmark \\
    2 & \cmark \\
    p & p \equiv 1 \, (4) \\
    2p & p \equiv 1 \, (4) \\
    -1 & \xmark \\
    -2 & \xmark \\
    -p & p \equiv 3 \, (4) \\
    -2p & p \equiv 3 \, (4)
  \end{tabu} $
\end{thm}
\begin{proof}
  Note that $x^4 \equiv 1 \, (16)$ if $x$ is odd and 0 if it's even. Also
  note that the squares modulo 16 are 0, 1, 4 and 9. Since
  $M, e$ cannot both be even, we can check the following cases:
  \begin{itemize}
    \item If $d_1 = 2$, $N^2 \equiv \begin{cases} 2 + 2p^2 \\ 2 \\
        2p^2 \end{cases} \, (16)$. \newline In particular, since $p^2 = 1$ or 9,
      we can take the option
      $2 + 2p^2 \equiv 4 \equiv 2^2 \, (16)$.
    \item If $d_1 = p$, $N^2 \equiv \begin{cases} p + 4p \\ p \\
        4p \end{cases} \, (16)$. \newline If $p \equiv 1 \, (4), 4p \equiv 1 \, (16)$.
      The first equation has no solution since $5^{-1} \equiv 13 \not\equiv N^2
      \, (16)$.
    \item If $d_1 = 2p$, $N^2 \equiv \begin{cases} 2p +2p \\ 2p \\
        2p \end{cases} \, (16)$. \newline We have a solution if $p \equiv 1
      \, (4)$.
    \item If $d_1 = -1$, $N^2 \equiv \begin{cases} -1 -4 p^2 \\ -1 \\
        -4p^2 \end{cases} \, (16)$. \newline There are no solutions, since $p^2 = 1, 9$.
    \item If $d_1 = -2$, $N^2 \equiv \begin{cases} -2 - 2p^2 \\ -2\\
        -2p^2 \end{cases} \, (16)$. \newline There are also no solutions.
    \item If $d_1 = -p$, $N^2 \equiv \begin{cases} -p -4p \\ -p \\
        -4p \end{cases} \, (16)$. \newline The first 2 equations have no solutions, 
      since $-5^{-1} \equiv 3$ and $-1^{-1} \equiv -1$, and neither is a square.
      If $N^2 = 4 \equiv -4p \, (16), p \equiv -1 \, (4)$.
    \item If $d_1 = -2p$, $N^2 \equiv \begin{cases} -2p -2p \\ -2p \\
        -2p \end{cases} \, (16)$. If $N^2 \equiv 0 \, (16)$, there are no
      solutions since p is odd. If $N^2 \equiv 4 \, (16), p \equiv -1 \, (4)$.
  \end{itemize}
\end{proof}

We can now put everything together to work out the Selmer rank of $E_p$.

$  \begin{tabu}{l*{5}{c}r}
    d_1 & \text{l-adic} & \text{p-adic} & \text{2-adic} & \RR & \Sel \\
    \hline
    1 & \cmark & \cmark & \cmark & \cmark & \cmark \\
    2 & \cmark & p \equiv \pm 1 \, (8) & \cmark & \cmark & p \equiv \pm 1 \, (8) \\
    p & \cmark & p \equiv 1 \, (4) & p \equiv 1 \, (4) & \cmark & p \equiv 1 \, (4) \\
    2p & \cmark & p \equiv 1 \, (8) & p \equiv 1 \, (4) & \cmark & p \equiv 1 \, (8)\\
    -1 & \cmark & p \equiv 1 \, (4) & \xmark & \xmark & \xmark \\
    -2 & \cmark & p \not\equiv 5 \, (8) & \xmark & \xmark & \xmark \\
    -p & \cmark & p \equiv 1 \, (4) & p \equiv 3 \, (4) & \xmark & \xmark \\
    -2p & \cmark & p \equiv 1 \, (8) & p \equiv 3 \, (4) & \xmark & \xmark 
  \end{tabu}$

\begin{cor}
  The Selmer rank of $E$ is equal to 2 if $p \equiv 1 \, (8), 1$ if $p \equiv
  3, 7 \, (8)$, and 0 if $p \equiv 5 \, (8)$.
\end{cor}
\begin{proof}
  Let $r$ be the Selmer rank, then
  \[2^r = \frac{\#\Sel(E) \cdot \#\Sel(\Eb)}{4} = \#\Sel(\Eb) =
    \begin{cases}
      4 & \text { if } p \equiv 1 \, (8) \\
      2 & \text{ if } p \equiv 3, 7 \, (8) \\
      1 & \text { otherwise}
    \end{cases}\]
\end{proof}

\subsection{Tamagawa Numbers}

The final step of our calculations is to work out the Tamagawa numbers of the
curves $E_n$. Recall that
\[ c_p = \left| \frac{E(\QQ_p)}{E(\QQ_p)_0} \right|\]
where $\EQp_0$ is the preimage of the nonsigular points of the reduced curve
modulo $p$ of the homomorphism
\[ \EQp \ra \EFp.\]

We begin with a straightforward lemma.

\begin{lemma} \label{singularity_condition}
  The curve
  \[ \EFp : y^2 \equiv x^3 - n^2x \mod{p}\]
  is nonsigular unless $p \, | \, 2n$.

  If $p = 2$ the singular point if $(1,0)$.

  If $p \, | \, n$ the singuar point is $(0,0)$.

\end{lemma}

\begin{proof}
  Since $\OO$ may could also turn out to be singular, we consider
  the projective comlpletion completion
  \[f(x,y,z) = y^2z - x^3 + n^2 xz^2.\]
  A point is singular if and only if all partial derivatives vanish.
  We have
  \begin{equation*}
    \begin{split}
      \parder{f}{x} &= -3x^2 + n^2z^2 \\
      \parder{f}{y} &= 2yz \\
      \parder{f}{z} &= y^2 + n^2x
    \end{split}
  \end{equation*}
 
  There are 3 cases to consider.
  
  \begin{itemize}
  \item If $p = 2$, working in $\FF_2$ we get
    \[\parder{f}{x} = x^2+z^2 = (x-z)^2, \,\,\,\,
      \parder {f}{y} = 0, \,\,\,\,
      \parder{f}{z} = y^2.\]
    Thus, we must have $x = z$ and $ y = 0$. Since $x, y, z$ can't be 0
    simultaneously, the only candidate is the point $(1:0:1)$, which
    is in fact in the curve, and descends to the point $(1,0)$ in the
    affine model.
    
  \item If $p | n$, working in $\FF_n$ we get
    \[  \parder{f}{x} = -3x^2, \,\,\,\,
        \parder{f}{y} = 2yz, \,\,\,\,
        \parder{f}{z} = y^2.
      \]
    If $y = 0$, we have $f(x,y,z) = -x^3 = 0$, so $x = 0$.
    Thus,  only $(0:0:1)$ is singular, and it descends to the point $(0,0) \in \EFp$.

  \item If $p \not| \,\, 2n$, the equations for the partial derivatives
    require us to have either $y = 0$ or $z = 0$.
   
    If $z = 0$, we must have $-x^3 = 0$, so $y = 1$. But then $\parder{f}{z}
    \neq 0$.

    If $y = 0, \parder{f}{z} = n^2x = 0$, so $x = 0$, and $\parder{f}{x} =
    n^2z^2 = 0$ and $ z = 0$, a contradiction.

    Thus, there are no singular points on $\bar{E_n}(\FF_p)$ if $p \not|
    \,\, n$. \qedhere
  \end{itemize}
\end{proof}

As an easy application, we have

\begin{cor}
  If $p \not| \,\, 2n$, the Tamagawa number $c_p = 1$.
\end{cor}

\begin{proof}
  In this case, all points are nonsigular, so $\EQp_0 = \EQp$, and
  \[c_p = \left| \{1\} \right| = 1\]
  as wanted.
\end{proof}

It now remains to consider the Tamagawa number at the primes where $E_n$ has
bad reduction. We first consider the case where $p \, | \, n$. To do this
we will give an explict parametrization for the homomorphism
\[\psi : \EQp \ra \EFp\]

Working in $\QQ_p$, if $x \equiv 0 \, (p)$ then
\[y^2 = x^3 - p^{2}b^2 x \equiv 0 \mod{p^2}, \]
where we write $n = p b$ with $p \not| \,\, b $, since $n$ is squarefree.
Thus, $y \equiv 0 \, (p)$ and we have the singular point.

If $x \not\in \ZZ_p^\times$, we can write $x = p^{-n} u$ for some $u \in
\ZZ_p^\times$, and
\[y^2 = p^{-3n}u^3 - p^{2-n}b^2u,\]
so $n$ must be even. Writing $n = 2m$ we get
\[p^{6m}y^2 = u^3 - p^{2+2m}b^2u.\]
We can't have $p^{6m}y^2 \equiv 0 \, (p)$ since then
$u \equiv 0 \, (p),$ a contradiction. Thus we can write
$y = p^{-3m}v$ for some $v \in \Zpx$. We arrive at the equation
\[v^2 = u^3 - p^{2+2m}b^2u, \text{ with } u, v \in \Zpx,\]
giving
\[v^2 \equiv b^2u^3 \mod{p}.\]
For this to have a solution, we must have $\legendre{u}{p} = 1,$
so $x$ is the reciprocal of a square in $\ZZ_p$.

Setting 
\[x = \frac{1}{r^2}, \,\, r \in \ZZ_p\]
we get
\[y^2 = \frac{1}{r^6}-{n^2}{r^2} = \frac{1-n^2r^4}{r^6}.\]

We can thus parametrise the points in $\EQp_0$ by the map
\[
    P : \ZZ_p \ra \EQp_0  \]
mapping
\begin{equation} \label{eq:p-param}
  \begin{split}
    r &\mapsto (\frac{1}{r^2}, \frac{\sqrt{1-n^2r^4}}{r^3}), \text{ if } r \neq 0 \\
    0 &\mapsto \OO.
  \end{split}
\end{equation}

We are now ready to investigate the quotient group $\left| \frac{\EQp}{\EQp_0}
\right|$.

\begin{thm}
  If $p \, | \, n, n$ squarefree, the torsion points $\OO, (0,0), (n,0), (-n,0)$
  are a complete set of representatives for $\frac{\EQp}{\EQp_0}$.
\end{thm}
\begin{proof}
  From \autoref{eq:p-param} we have, for $r \in \ZZ_p$,
  $P(r) = (\frac{1}{r^2}, \frac{\sqrt{1-n^2r^4}}{r^3}) = (x,y)$.

  \textbf{Step 1:} We will compute $$S := P(r) + Q$$ for each torsion point $Q$ using
  the addition formulas from \autoref{eq:adddiff}.
   
  If $Q = \OO$: $P(r) + \OO = P(r)$.

  Now suppose the line between $P(r)$ and $Q$ is given by
  \[y = \lambda x + \nu.\]

  \begin{itemize}
    
  \item If $Q = \OO$: $S = P(r) + \OO = P(r)$, and
    \[x(S) = \frac{1}{r^2}.\]
    Since $r \in \ZZ_p$, we have in particular
    \[x(S) \not\equiv 0 \mod{p}.\]
    
  \item If $Q = (0,0)$:
  We have $\lambda = \frac{y}{x}$, so
  \begin{equation*}
    \begin{split}
      x(S)
      &= \lambda^2 - x - 0 =
      \frac{\frac{1 - n^2r^4}{r^6}}{\frac{1}{r^4}} - \frac{1}{r^2} \\
      &= -n^2r^2 = -p^2b^2r^2.
    \end{split}
  \end{equation*}
  In particular, 
  \[x(S) \equiv 0 \mod{p^2}.\]
  
\item If $Q = (n, 0)$: We have $\lambda = \frac{y}{x-n} =
  \frac{\frac{\sqrt{1-n^2r^4}}{r^3}}{\frac{1-nr^2}{r^2}}$, so
  \begin{equation*}
    \begin{split}
      x(S)
      &= \lambda^2 - x - n = 
      \frac{\frac{1 - n^2r^4}{r^6}}{\frac{(1-nr^2)^2}{r^4}} -
      \frac{1}{r^2} - n \\
      &= \frac{1-n^2r^4}{r^2(1-nr^2)^2} - \frac{1+nr^2}{r^2} \\
      &= -n + \frac{2n}{1-nr^2}
    \end{split}
  \end{equation*}
  But considering the $p$-adic power series for the quotient, we have
  \[\frac{1}{1-nr^2} = 1 - nr^2 + O(n^2) \equiv 1-nr^2 \, (p^2),\] and 
  \[-n + \frac{2n}{1-nr^2} \equiv -n + 2n - 2n^2r^2 \equiv n \, (p^2).\]
  Thus, in this case we have
  \[x(S) \equiv pb \mod{p^2}.\]

  \item If $Q = (-n, 0)$: We have $\lambda = \frac{y}{x+n}$, so
  \begin{equation*}
    \begin{split}
      x(S)
      &= \lambda^2 - x + n = 
      \frac{\frac{1 - n^2r^4}{r^6}}{\frac{(1+nr^2)^2}{r^4}} -
      \frac{1}{r^2} + p \\
      &= n - \frac{2n}{1+nr^2}
    \end{split}
  \end{equation*}
  A similar calculation shows that 
  \[x(S) \equiv -pb \mod{p^2}.\]
  \end{itemize}

  As a consequence, the 4 cosets are distinct, since the $x$ coordinates of
  $P(r) + Q$ for each $Q$ are all incongruent modulo $p^2$.

  \textbf{Step 2:} We now show that indeed those are all the possibilities for $x$ modulo $p^2$.

  Note that if $x \not\equiv 0 \, (p)$, then also $y \not\equiv 0 \, (p)$, so
  $(x,y) \neq (0,0)$ in $\EFp$ and thus $(x,y)$ is the preimage of a nonsigular
  point, and belongs to the trivial coset $\EQp_0$.

  Otherwise, if $x \equiv 0 \, (p)$,
  \[y^2 = x^3 - p^2b^2x\equiv 0 \,(p^3)\]
  so
  \[y \equiv 0 \, (p^2)\]
  and
  \[ x^3-p^2b^2x \equiv 0 \, (p^4).\]
  Letting $x = pa$ we get
  \[p^3a^3-p^3b^2a \equiv 0 \, (p^4)\]
  so finally
  \[a^3 - b^2a \equiv 0 \, (p).\]
  Since $\FF_p$ is a field, we have unique factorization and thus must have
  $a \equiv 0, \pm b \, (p)$, so
  \[x \equiv 0, bp, -bp \mod{p^2}\]
  as wanted.

  \textbf{Step 3:} The next step is to show that indeed those cosets span all of
  $\frac{\EQp}{\EQp_0}$. To do this we need to show that for each possible
  residue $x \equiv 0, bp, -bp \, (p^2)$ we can solve for $r$ to find a preimage
  in $\ZZ_p$.

  Let $S = (x,y).$ Again we proceed in cases.

  \begin{itemize}
    \item If $x \equiv 0 \, (p^2),$ we can write $x = p^2t$ for some $t \in
      \ZZ_p$. We want to show that $S$ is a member of the coset $P(r) + (0,0)$,
      i.e. that we can solve
      \[x = -p^2b^2r^2\]
      for some $r \in \ZZ_p$.
      From the equation of the curve we have
      \begin{equation*}
        \begin{split}
          y^2 &= x^3 - (pb)^2x \\
          &= x(x+pb)(x-pb) \\
          x &= \frac{y^2}{(x+pb)(x-pb)} \\
          &= \frac{-y^2}{p^2(1+tpb)(1-tpb)}
        \end{split}
      \end{equation*}
      where in the last line we substituted our hypothesis $x = p^2t.$ But
      $1 + tpb$ and $1-tpb$ are squares in $\ZZ_p$, since they are congruent to
      1 modulo $p$, $\legendre{1}{p} = 1$, and we can lift them noting that
      $\nu_p(1 \pm tpb) = 0$. Thus, 
      \[\sqrt{-x} = \frac{y}{p (1+tpb)^{1/2} (1-tpb)^{1/2}}, \in \QQ_p,\]
      and is in fact in $\ZZ_p$ since $x$ also is. Finally, we have the solution
      \[r = \frac{\sqrt{-x}}{pb},\]
      so indeed $S \in P(r) + (0,0).$


    \item If $x \equiv pb \, (p^2)$, we want to show that $S \in P(r) + (n,0)$.
      Writing $x = pb + tp^2$ for some $t \in \ZZ_p$, we want to find $r \in
      \ZZ_p$ such that
      \[x = -n + \frac{n}{1-nr^2} \]
      or equivalently
      \[r^2 = \frac{1}{n} \cdot \frac{x-n}{x+n}. \]
      Again using the equation of the curve,
      \[ \begin{split} r^2 &= \frac{1}{n} \cdot \frac{x (x-n)^2}{x
            (x+n)(x-n)} \\
          &= \frac{(x-n)^2x}{n y^2}. \\
        \end{split}\]
      But $x = pb + p^2t$, so
      \[ r^2 = \left(\frac{x-n}{y}\right)^2 (1+pb^{-1}t).\]
      A similar argument to the above case shows that $1+pb^{-1}t$ is
      a square in $\ZZ_p$ enabling us to solve for $r \in \ZZ_p$.
      Thus, we have $S \in P(r) + (n,0)$.

    \item If $x \equiv -pb \, (p^2)$, we want to show that $S \in P(r) +
      (-n,0)$. After writing $x = -pb + tp^2$, an entirely analogous computation
      to the previous case using the corresponding formulas gives
      \[r^2 = \left( \frac{x+n}{y} \right)^2 (1 - pb^{-1}t).\]
      Again we know $1-pb^{-1}t$ is a square in $\ZZ_p$, and can solve for
      $r$. Thus, we have $S \in P(r) + (-n,0)$.
  \end{itemize}

  Since, as we noted, the cosets are distinct, this finishes the proof of the theorem.
\end{proof}

As an immediate consequence, we have: 

\begin{thm}
  Let $n$ be a odd squarefree integer.
  If $p \not| \,\, 2n $, the Tamagawa number $c_p$ of $E_n$ is 4.
\end{thm}

It remains to compute the Tamagawa number of $E_n$ at 2.

\begin{thm}
  Let $n$ be an odd squarefree integer. Then the Tamagawa number $c_2$
  of $E_n$ is 2.
\end{thm}

\begin{proof}
  Modulo 2, the equation of the curve reduces to
  \[y^2 = x^3 - x.\]
  Checking manually, we get that 
  \[\tilde{E}(\FF_2) = \{\OO, (0,0), (1,0)\},\]
  where we remember that $(1,0)$ is the singular point
  (see \autoref{singularity_condition}).
  Let $P = (x,y) \in E(\QQ_2)$. We will consider the homomorphism
  \[\pi: E(\QQ_2) \ra \tilde{E}(\FF_2)_{ns}.\]

  We have
  \[E(\QQ_2)_0 = \{P \in E(\QQ_2) \, | \, \pi(P) \in \{ \OO, (1,0)\}\}.\]
  We need to show that
  \[\left| \frac{E(\QQ_2)}{E(\QQ_2)_0} \right| = 2.\]
  Clearly $\OO$ has it's own coset, so we only need to show that the preimages
  of $(0,0)$ and $(1,0)$ are in the same coset.
  
  Equivalently, we will show that if $\pi(P) = (1,0)$, then there is an
  element $Q \in E(\QQ_2)_0$ such that $\overline{P+Q} = \overline{(0,0)}$,
  i.e. $\pi(P+Q) = (0,0)$.
  
  Assume $\pi(P) = (1,0)$, so $P$ is the preimage of the nonsigular point.
  Let $(u,v) = P + (1,0)$. It will be sufficient to show that $\pi(u,v) = (0,0)$.

  If not, then $u \in \ZZ_2^{\times}$ is a unit. Let $\lambda$ be the gradient of the
  line between $(x,y), (n,0)$ and $(u,v)$, so $\lambda = \frac{y}{x-n}$.
  From the addition formulas, we have
  \[u = \lambda^2 - x - n,\]
  so $\lambda^2 = u + x + n \equiv 1 + 1 + 1\, (2)$, and we see that $\lambda$
  is a 2-adic unit. Writing
  \[\lambda = \frac{y}{x-n} = w \in \ZZ_2^{\times},\]
  we have
  \[(w(x-n))^2 = y^2 = x^3 -nx = x(x+n)(x-n),\]
  so
  \[w^2 = \frac{x(x+n)}{x-n}.\]
  Since $x$ is a unit, $\frac{x+n}{x-n}$ must also be.

  This is a contradiction since if
  $$x+n = 2^n, n \in \NN,$$ then $$x-n = 2^n - 2n
  = 2^{n-1}(2-n).$$
  But $2-n$ odd, so $x+n$ and $x-n$ must have different 2-adic
  valuations, and their quotient can't be a unit.

  Thus, $u$ is not a unit, and $\pi(P+(n,0)) \neq (1,0)$, which concludes our proof.
\end{proof}


\printbibliography

\end{document}